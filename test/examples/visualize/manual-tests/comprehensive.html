<!DOCTYPE html>
<html>
<head>
  <title>Keen IO Comprehensive Test</title>
<link rel="stylesheet" href="keen-bootstrap.min.css">
<link rel="stylesheet" href="keen-gotham.css">
<link rel="stylesheet" href="keen-dashboards.css">
<style>
body {
  padding: 0;
  border: 0;
}

</style>

</head>
<body>

<!-- 
<div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../">
        <span class="glyphicon glyphicon-chevron-left"></span>
      </a>
      <a class="navbar-brand" href="./">Dashboard Starter UI</a>
    </div>
    <div class="navbar-collapse collapse">
      <ul class="nav navbar-nav navbar-left">
        <li><a href="https://keen.io">Home</a></li>
        <li><a href="https://keen.io/team">Team</a></li>
        <li><a href="https://github.com/keenlabs/dashboards/tree/gh-pages/starter-kit">Source</a></li>
        <li><a href="https://users.keen.io">Chat Support</a></li>
      </ul>
    </div>
  </div>
</div>
-->

<h1>Comprehensive Visual Tests</h1>
<div class="container-fluid">
  <div class="row">
  </div>
</div>

    
</body>
<script src="../../../dist/keen.js"></script>
<script>

// We'll be using dummy data
var keen = new Keen({
  projectId: "52f2ae5905cd661a7800000a",
  readKey: "4e4d72e5bf8b69686ed87a5a9671bba7ad829fbd10a1c281ee51b6e9c1ce9548e941e1f336f9de9281a5acc66ca8fdabc9b3c806e390eca01665f6a308a9b03d8b332b3fbd9f3cdfc3b3e16b0da6d84851e53fe20fbbce300801b8a401a6395b9f4ab9c89bff566e9678a74ca6624f9b",
  requestType: "jsonp"
});

/**
 * 
 * Metric
 * Group by
 * interval
 * Group by-interval
 * Extractions = table outputA
 * var chart.js = ['Line', 'Bar', 'Radar', 'PolarArea', 'Pie', 'Doughnut'];
 * var google = ['AreaChart', 'BarChart', 'ColumnChart', 'LineChart', 'PieChart', 'Table'];
 * c3 = ['spline', 'pie', 'donut', 'area-spline', 'bar', 'scatter'];

 */

var libraries = [
{
  name: 'google',
  chartTypes: ['linechart', 'piechart', 'barchart', 'columnchart', 'table']
},
{
  name: 'c3',
  chartTypes:  ['spline', 'pie', 'bar', 'donut', 'area-spline', 'scatter']
},
{
  name: 'chart.js',
  chartTypes: ['Line', 'Pie', 'Bar', 'Radar', 'PolarArea', 'Doughnut']
}];

Keen.ready(function() {
  var labelMapping = {
    null: 'N/A',
    "file://localhost/Users/Larimer/Downloads/gist3a84fb3288737047e173-05ee2560c1be278096416081960b98ff0104ea4d/index.html": "Home",
    "file://localhost/Users/Larimer/dev/keen/sandbox/video.js%20plugin/index.html": "Video page"
  };
  var metric = new Keen.Query("count", {
    event_collection: "pageview"
  });

  var groupBy = new Keen.Query("count", {
    event_collection: "pageview",
    group_by: "page"
  });

  var multiline = new Keen.Query("count", {
    event_collection: "pageview",
    group_by: "page",
    timeframe: "this_12_months",
    interval: "monthly"
  });
  var generateRandomData = function(res) {
    var newData = res;
    for (var i = 0; i < res.result.length; i++) {
      for (var j = 0; j < res.result[i].value.length; j++) {
        newData.result[i].value[j].result = Math.floor(Math.random() * (500 - 100 + 1)) + 100;
      }
    }
    return newData;
  }

  var makeNewLibNode = function() {
    var node = document.createElement('div');
    node.className = 'col-sm-' + Math.floor(12 / libraries.length);
    document.querySelector('.container-fluid>.row').appendChild(node);
    return node;
  };

  /**
  <div class="chart-wrapper">
    <div class="chart-title">
      Total Acquisitions, by State (5 yr)
    </div>
    <div class="chart-stage">
      <div id="grid-1"></div>
    </div>
    <div class="chart-notes">
      Notes about this chart
    </div>
  </div>
   */
  var makeNewCell = function(parent, lib, index) {
    var row = document.createElement('div');
    row.innerHTML = [
      '<div class="chart-wrapper">',
        '<div class="chart-title">',
          '</div>',
          '<div class="chart-stage">',
          '</div>',
      '</div>'
    ].join('');
    var type = 'div';
    if(lib.name === 'chart.js') {
      type = 'canvas';
    }
    var cell = document.createElement(type);
    row.className = 'row';
    cell.className = 'col-sm-12';
    row.querySelector('.chart-stage').appendChild(cell);
    row.querySelector('.chart-title').innerHTML = lib.chartTypes[index];
    parent.appendChild(row);
    return cell;
  };

  keen.run(multiline, function(res) {
    var columns = [];
    for(var i = 0; i < libraries.length; i++) {
      var column = makeNewLibNode();
      columns.push(column);
      for(var x = 0; x < libraries[i].chartTypes.length; x++) {
        this.data = generateRandomData(res);
        var el = makeNewCell(columns[i], libraries[i], x);

        new Keen.Visualization(res, el, {
          library: libraries[i].name,
          chartType: libraries[i].chartTypes[x],
          labelMapping: labelMapping,
          chartOptions: {
            chartArea: {
              height: "75%",
              left: "10%",
              top: "5%",
              width: "60%"
            },
            bar: {
              groupWidth: "85%"
            },
            isStacked: true
          }
        });
      }
    }
  }); 

});



</script>
</html>